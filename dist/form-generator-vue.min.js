var FormGeneratorVue=function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,o,n,r,i,l){try{var s=e[i](l),u=s.value}catch(e){return void o(e)}s.done?t(u):Promise.resolve(u).then(n,r)}function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var l,s={props:{value:{type:Object,default:null,required:!1},onSubmit:{type:Function,required:!1,default:function(){console.error("submit handler not present")}},components:{type:Array,required:!1,default:function(){return[]}},disabled:{type:Boolean,required:!1,default:!1},schema:{type:Object,default:function(){return{}}},classes:{type:Object,required:!1,default:function(){return{}}},onSubmitFail:{type:Function,required:!1,default:function(){console.warn("Form submit fail")}},activeValidation:{type:Boolean,required:!1,default:!1},activeValidationDelay:{type:Number,required:!1,default:0},logs:{type:Boolean,required:!1,default:!1}}},u={isUndef:function(e){return void 0===e},isObjNotArr:function(e){return u.isArr(e)?e.every((function(e){return u.isObj(e)&&!u.isArr(e)})):u.isObj(e)&&!u.isArr(e)},isObj:function(e){return u.isArr(e)?e.every((function(e){return"object"===t(e)})):"object"===t(e)},isArr:function(e){return Array.isArray(e)},isFunc:function(e){return"function"==typeof e},isBool:function(e){return"boolean"==typeof e},isStr:function(e){return"string"==typeof e},throwError:function(e){throw new Error(e)},warn:function(e){console.warn(e)},hasProperty:function(e,t){return u.isArr(e)?e.every((function(e){return e in t})):e in t},handleFunc:function(e){if(u.isFunc(e))return e()},handleFuncOrBool:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=Boolean(e);return u.isFunc(e)&&(o=e(t)),o},debounce:function(e){return function(t){return function(o){clearTimeout(l),l=setTimeout((function(){clearTimeout(l),e(o)}),t)}}}},a={form:"fgv-form",header:"fgv-form__header",body:"fgv-form__body",footer:"fgv-form__footer",row:"fgv-form__body__row",col:"fgv-form__body__row__col"},d={header:"header",footer:"footer",beforeComponent:function(e){return"before-".concat(e)},afterComponent:function(e){return"after-".concat(e)},beforeRow:"before-row",afterRow:"after-row",beforeCol:"before-col",afterCol:"after-col"},c="fields",f="values",m="errors",h="activeValidation",v="activeValidationDelay",p="v-on",b="component",y="hide",_={text:"text",number:"number"},S={required:"required",disabled:"disabled"};function O(e,t,o,n,r,i,l,s,u,a){"boolean"!=typeof l&&(u=s,s=l,l=!1);const d="function"==typeof o?o.options:o;let c;if(e&&e.render&&(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,r&&(d.functional=!0)),n&&(d._scopeId=n),i?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,u(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},d._ssrRegister=c):t&&(c=l?function(e){t.call(this,a(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,s(e))}),c)if(d.functional){const e=d.render;d.render=function(t,o){return c.call(o),e(t,o)}}else{const e=d.beforeCreate;d.beforeCreate=e?[].concat(e,c):[c]}return o}var w=O({render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("form",{class:[e.CLASS.form],on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[o("div",{class:[e.CLASS.header]},[e._t(e.SLOT.header)],2),e._v(" "),o("div",{class:[e.CLASS.body]},[e._l(e.fieldsSchema,(function(t,n){return[e.showRow(t)?e._t(e.SLOT.beforeRow,null,{model:e.slotProps(t)}):e._e(),e._v(" "),e.showRow(t)?o("div",{key:n,class:[e.CLASS.row,e.classes.row]},[e.UTILS.isArr(t)?[e._l(t,(function(t){return[e.showCol(t)?e._t(e.SLOT.beforeCol,null,{model:e.slotProps(t)}):e._e(),e._v(" "),e.showCol(t)?o("div",{key:t.model,class:[e.CLASS.col,t.model,e.classes.col]},[e._t(e.SLOT.beforeComponent(t.model)),e._v(" "),o(e.componentToRender(t),e._g(e._b({tag:"component",model:{value:e.fields[t.model],callback:function(o){e.$set(e.fields,t.model,o)},expression:"fields[s.model]"}},"component",e.componentProps(t),!1),e.componentEvents(t)),[e._t(t.model)],2),e._v(" "),e._t(e.SLOT.afterComponent(t.model))],2):e._e(),e._v(" "),e.showCol(t)?e._t(e.SLOT.afterCol,null,{model:e.slotProps(t)}):e._e()]}))]:[e.showCol(t)?e._t(e.SLOT.beforeCol,null,{model:e.slotProps(t)}):e._e(),e._v(" "),e.showCol(t)?o("div",{key:t.model,class:[e.CLASS.col,t.model,e.classes.col]},[e._t(e.SLOT.beforeComponent(t.model)),e._v(" "),o(e.componentToRender(t),e._g(e._b({tag:"component",model:{value:e.fields[t.model],callback:function(o){e.$set(e.fields,t.model,o)},expression:"fields[schema.model]"}},"component",e.componentProps(t),!1),e.componentEvents(t)),[e._t(t.model)],2),e._v(" "),e._t(e.SLOT.afterComponent(t.model))],2):e._e(),e._v(" "),e.showCol(t)?e._t(e.SLOT.afterCol,null,{model:e.slotProps(t)}):e._e()]],2):e._e(),e._v(" "),e.showRow(t)?e._t(e.SLOT.afterRow,null,{model:e.slotProps(t)}):e._e()]}))],2),e._v(" "),o("div",{class:e.CLASS.footer},[e._t(e.SLOT.footer)],2)])},staticRenderFns:[]},void 0,{mixins:[s],emits:["input"],data:function(){var e,t=this,o={},n={},r=this.vModelValid(!0),i=u.isArr(null===(e=this.schema)||void 0===e?void 0:e[c])&&this.schema[c].length,l=function(e){var i,l;o[e]=r&&(null===(i=t.value[f])||void 0===i?void 0:i[e])||"",n[e]=r&&(null===(l=t.value[m])||void 0===l?void 0:l[e])||""};return i&&this.schema[c].forEach((function(e){u.isArr(e)?e.forEach((function(e){l(e.model)})):l(e.model)})),{fields:o,errors:n,submit:!1}},computed:{SLOT:function(){return d},CLASS:function(){return a},UTILS:function(){return u},avGlobal:function(){return this.activeValidation||!1},avDelayGlobal:function(){return this.activeValidationDelay||0},fieldsSchema:function(){var e;return u.isArr(null===(e=this.schema)||void 0===e?void 0:e[c])?this.schema[c]:[]},fieldsSchemaFlat:function(){var e=[];return this.fieldsSchema.forEach((function(t){u.isArr(t)?t.forEach((function(t){e.push(t)})):e.push(t)})),e},fieldsSchemaMap:function(){var e=this.fieldsSchemaFlat.map((function(e){return[e.model,e]}));return Object.fromEntries(e)},debValidateField:function(){var e=this;return u.debounce((function(t){e.validateField(t)}))}},watch:{disabled:{handler:function(e){e&&this.removeAllErrors()}},value:{handler:function(){var e=this;this.vModelValid()&&Object.keys(this.value[f]).forEach((function(t){e.fields[t]=e.value[f][t],e.errors[t]=e.value[m][t]}))},deep:!0},fields:{handler:function(){this.rmUnwantedModels(),this.$emit("input",{values:this.fields,errors:this.errors})},deep:!0,immediate:!0}},created:function(){var e=this;Object.keys(this.fields).forEach((function(o){var n=e.findSchema(o);e.$watch("fields.".concat(o),(function(o,r){e.typeCoercion(n),o==r&&t(o)!==t(r)||e.validate(n,!0)}),{deep:!0})}))},methods:{slotProps:function(e){return u.isArr()?e.map((function(e){return e.model})):e.model},validate:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t||!o){var n={};Object.values(this.fieldsSchemaMap).forEach((function(t){var o=e.validateField(t);n[t.model]=!o||!e.fieldRequired(t)}));var r=Object.keys(n).find((function(e){return!n[e]}));return{valStatus:n,submitFail:r}}var i=t[h]||this.avGlobal,l=t[v]||this.avDelayGlobal;i&&l?this.debValidateField(l)(t):this.validateField(t)},showRow:function(e){return this.hasFieldsToRender(e)||this.showCol(e)},hasFieldsToRender:function(e){var t=this;return u.isArr(e)&&e.length&&e.some((function(e){return!t.fieldHidden(e)}))},showCol:function(e){return this.componentToRender(e)&&!this.fieldHidden(e)},vModelValid:function(){var e,t,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.value&&u.isObjNotArr(this.value),r=u.isObjNotArr(null===(e=this.value)||void 0===e?void 0:e[f]),i=u.isObjNotArr(null===(t=this.value)||void 0===t?void 0:t[m]);return o?n&&r:n&&r&&i},resetForm:function(){this.submit=!1},removeAllErrors:function(){var e=this;Object.keys(this.errors).forEach((function(t){e.errors[t]=""}))},setError:function(e,t){var o=this.errors[e];o===t||u.isObj([o,t])&&JSON.stringify(o)===JSON.stringify(t)||(this.errors[e]=t)},findComponentData:function(e){return this.components.find((function(t){return t&&t.name===e}))},componentProps:function(e){var t,o=this.componentToRender(e),r=this.findComponentData(o),l=(null==e?void 0:e.errorProp)||(null==r?void 0:r.errorProp)||"errorMessages";return i(i({},e.props),{},(n(t={},l,this.errors[e.model]),n(t,"ref",e.model),n(t,"type",e.type||_.text),n(t,"disabled",this.fieldDisabled(e)),n(t,"required",this.fieldRequired(e)),t))},typeCoercion:function(e){Number.isNaN(Number(this.fields[e.model]))&&(null==e?void 0:e.type)===_.number&&this.fields[e.model]&&(this.fields[e.model]=Number(this.fields[e.model]))},componentEvents:function(e){return u.isObj(null==e?void 0:e[p])?e[p]:{}},componentToRender:function(e){var t=e.type||_.text;if((null==e?void 0:e[b])&&u.isStr(e[b]))return e.component;var o=this.components.find((function(e){return e.type.includes(t)})),n=null==o?void 0:o.name;return n||console.error('Component cannot be rendered. Component for type "'.concat(t,'" is not found in form-components.')),n},findSchema:function(e){return this.fieldsSchemaMap[e]},fieldDisabled:function(e){var t=!!(u.isObj(null==e?void 0:e.props)&&S.disabled in e.props)&&u.handleFuncOrBool(e.props[S.disabled]);return!(!this.disabled&&!t)},fieldRequired:function(e){var t=!!(e&&e.props&&S.required in e.props)&&u.handleFuncOrBool(e.props[S.required]);return!(!e||this.fieldDisabled(e)||this.fieldHidden(e))&&t},rmUnwantedModels:function(){var e=this;Object.keys(this.fields).filter((function(t){return!e.fieldsSchemaFlat.find((function(e){var o=e.model;return t===o}))})).forEach((function(t){delete e.fields[t],delete e.errors[t]}))},fieldHidden:function(e){var t=y in e&&u.handleFuncOrBool(e[y]);return t},validateField:function(e){var o=this.fieldRequired(e),n=null==e?void 0:e.validator,r=(null==e?void 0:e[h])||this.avGlobal,i=(this.submit||r)&&u.handleFunc(n)||"",l=!i||Boolean(i);return o?this.setError(e.model,i):this.submit||this.setError(e.model,i),this.logs&&console.log({model:e.model,value:this.fields[e.model],type:t(this.fields[e.model]),valid:l,required:o,error:i}),l},handleSubmit:function(){var e,t=this;return(e=regeneratorRuntime.mark((function e(){var o,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.submit=!0,t.rmUnwantedModels(),o=t.validate(),n=o.valStatus,r=o.submitFail,t.logs&&console.log("form validations:",n),!r){e.next=9;break}return t.resetForm(),e.next=8,t.onSubmitFail();case 8:return e.abrupt("return");case 9:return e.next=11,t.onSubmit();case 11:t.resetForm();case 12:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var l=e.apply(t,n);function s(e){o(l,r,i,s,u,"next",e)}function u(e){o(l,r,i,s,u,"throw",e)}s(void 0)}))})()}}},void 0,!1,void 0,!1,void 0,void 0,void 0),C=function(e){C.installed||(C.installed=!0,e.component("FormGeneratorVue",w))},g={install:C},F=null;return"undefined"!=typeof window?F=window.Vue:"undefined"!=typeof global&&(F=global.Vue),F&&F.use(g),w.install=C,e.default=w,e}({});