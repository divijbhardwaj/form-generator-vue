var FormGeneratorVue=function(e){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function t(e,n,t,o,r,i,l){try{var u=e[i](l),s=u.value}catch(e){return void t(e)}u.done?n(s):Promise.resolve(s).then(o,r)}function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}function u(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return l(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?l(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,s=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return u=e.done,e},e:function(e){s=!0,i=e},f:function(){try{u||null==t.return||t.return()}finally{if(s)throw i}}}}var s,a={props:{value:{type:Object,default:null,required:!1},onSubmit:{type:Function,required:!1,default:function(){console.error("submit handler not present")}},components:{type:Array,required:!1,default:function(){return[]}},disabled:{type:Boolean,required:!1,default:!1},schema:{type:Object,default:function(){return{}}},classes:{type:Object,required:!1,default:function(){return{}}},onSubmitFail:{type:Function,required:!1,default:function(){console.warn("Form submit fail")}},activeValidation:{type:Boolean,required:!1,default:!1},activeValidationDelay:{type:Number,required:!1,default:0},logs:{type:Boolean,required:!1,default:!1}}},d={isUndef:function(e){return void 0===e},isObjNotArr:function(e){return d.isArr(e)?e.every((function(e){return d.isObj(e)&&!d.isArr(e)})):d.isObj(e)},isObj:function(e){return d.isArr(e)?e.every((function(e){return"object"===n(e)})):"object"===n(e)},isArr:function(e){return Array.isArray(e)},isFunc:function(e){return"function"==typeof e},isBool:function(e){return"boolean"==typeof e},isStr:function(e){return"string"==typeof e},throwError:function(e){throw new Error(e)},warn:function(e){console.warn(e)},hasProperty:function(e,n){return d.isArr(e)?e.every((function(e){return e in n})):e in n},handleFunc:function(e,n){if(d.isFunc(e))return e(n)},handleFuncOrBool:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,t=Boolean(e);return d.isFunc(e)&&(t=e(n)),t},debounce:function(e){return function(n){return function(t){clearTimeout(s),s=setTimeout((function(){clearTimeout(s),e(t)}),n)}}}},c={form:"fgv-form",header:"fgv-form__header",body:"fgv-form__body",footer:"fgv-form__footer",row:"fgv-form__body__row",colContainer:"fgv-form__body__row__col-container",col:"fgv-form__body__row__col-container__col"},f={header:"header",footer:"footer",beforeComponent:function(e){return"before-".concat(e)},afterComponent:function(e){return"after-".concat(e)},beforeRow:"before-row",rowStart:"row-start",rowend:"row-end",afterRow:"after-row",beforeCol:"before-col",afterCol:"after-col"},v="fields",m="fields",h="errors",p="activeValidation",b="activeValidationDelay",y="vOn",_={text:"text",number:"number"},w={required:"required",disabled:"disabled",hidden:"hidden"},S="rules";function O(e,n,t,o,r,i,l,u,s,a){"boolean"!=typeof l&&(s=u,u=l,l=!1);const d="function"==typeof t?t.options:t;let c;if(e&&e.render&&(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,r&&(d.functional=!0)),o&&(d._scopeId=o),i?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,s(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},d._ssrRegister=c):n&&(c=l?function(e){n.call(this,a(e,this.$root.$options.shadowRoot))}:function(e){n.call(this,u(e))}),c)if(d.functional){const e=d.render;d.render=function(n,t){return c.call(t),e(n,t)}}else{const e=d.beforeCreate;d.beforeCreate=e?[].concat(e,c):[c]}return t}var g=O({render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("form",{class:[e.CLASS.form],on:{submit:function(n){return n.preventDefault(),e.handleSubmit(n)}}},[t("div",{class:[e.CLASS.header]},[e._t(e.SLOT.header)],2),e._v(" "),t("div",{class:[e.CLASS.body]},[e._l(e.allFieldsArray,(function(n,o){return[e.showRow(n)?e._t(e.SLOT.beforeRow,null,{models:e.slotProps(n)}):e._e(),e._v(" "),e.showRow(n)?t("div",{key:o,class:[e.CLASS.row,e.classes.row]},[e._t(e.SLOT.rowStart,null,{models:e.slotProps(n)}),e._v(" "),t("div",{class:[e.CLASS.colContainer]},[e.UTILS.isArr(n)?[e._l(n,(function(n){return[e.showCol(n)?e._t(e.SLOT.beforeCol,null,{models:e.slotProps(n)}):e._e(),e._v(" "),e.showCol(n)?t("div",{key:n.model,class:[e.CLASS.col,n.model,e.classes.col]},[e._t(e.SLOT.beforeComponent(n.model)),e._v(" "),t(e.componentName(n),e._g(e._b({tag:"component",model:{value:e.fields[n.model],callback:function(t){e.$set(e.fields,n.model,t)},expression:"fields[subConf.model]"}},"component",e.componentProps(n),!1),e.componentEvents(n)),[e._t(n.model)],2),e._v(" "),e._t(e.SLOT.afterComponent(n.model))],2):e._e(),e._v(" "),e.showCol(n)?e._t(e.SLOT.afterCol,null,{models:e.slotProps(n)}):e._e()]}))]:[e.showCol(n)?e._t(e.SLOT.beforeCol,null,{models:e.slotProps(n)}):e._e(),e._v(" "),e.showCol(n)?t("div",{key:n.model,class:[e.CLASS.col,n.model,e.classes.col]},[e._t(e.SLOT.beforeComponent(n.model)),e._v(" "),t(e.componentName(n),e._g(e._b({tag:"component",model:{value:e.fields[n.model],callback:function(t){e.$set(e.fields,n.model,t)},expression:"fields[conf.model]"}},"component",e.componentProps(n),!1),e.componentEvents(n)),[e._t(n.model)],2),e._v(" "),e._t(e.SLOT.afterComponent(n.model))],2):e._e(),e._v(" "),e.showCol(n)?e._t(e.SLOT.afterCol,null,{models:e.slotProps(n)}):e._e()]],2),e._v(" "),e._t(e.SLOT.rowEnd,null,{models:e.slotProps(n)})],2):e._e(),e._v(" "),e.showRow(n)?e._t(e.SLOT.afterRow,null,{models:e.slotProps(n)}):e._e()]}))],2),e._v(" "),t("div",{class:e.CLASS.footer},[e._t(e.SLOT.footer)],2)])},staticRenderFns:[]},void 0,{mixins:[a],emits:["input"],data:function(){var e=this,n={},t={},o=this.schemaValid(),r=function(o){var r,i,l,u;n[o]=(null===(r=e.value)||void 0===r||null===(i=r[m])||void 0===i?void 0:i[o])||"",t[o]=(null===(l=e.value)||void 0===l||null===(u=l[h])||void 0===u?void 0:u[o])||""};return o&&this.schema[v].forEach((function(e){d.isArr(e)?e.forEach((function(e){r(e.model)})):r(e.model)})),{fields:n,errors:t,submit:!1}},computed:{SLOT:function(){return f},CLASS:function(){return c},UTILS:function(){return d},globalAv:function(){return this.activeValidation||!1},globalAvDelay:function(){return this.activeValidationDelay||0},allFieldsArray:function(){var e;return d.isArr(null===(e=this.schema)||void 0===e?void 0:e[v])?this.schema[v]:[]},allFieldsFlatArray:function(){var e=[];return this.allFieldsArray.forEach((function(n){d.isArr(n)?n.forEach((function(n){e.push(n)})):e.push(n)})),e},allFieldsFlatObj:function(){var e=this.allFieldsFlatArray.map((function(e){return[e.model,e]}));return Object.fromEntries(e)},debounceValidateField:function(){var e=this;return d.debounce((function(n){e.fieldValidation(n)}))}},watch:{disabled:{handler:function(e){e&&this.removeAllErrors()}},value:{handler:function(){var e,n=this;Object.keys((null===(e=this.value)||void 0===e?void 0:e[m])||{}).forEach((function(e){var t,o,r,i;n.fields[e]=null===(t=n.value)||void 0===t||null===(o=t[m])||void 0===o?void 0:o[e],n.errors[e]=null===(r=n.value)||void 0===r||null===(i=r[h])||void 0===i?void 0:i[e]}))},deep:!0},fields:{handler:function(){this.emitData()},deep:!0,immediate:!0}},created:function(){var e=this;Object.keys(this.fields).forEach((function(t){var o=e.fieldConf(t);e.$watch("fields.".concat(t),(function(t,r){e.typeCoercion(o),t==r&&n(t)!==n(r)||e.validate(o,!0)}),{deep:!0})}))},methods:{emitData:function(){var e;this.$emit("input",(o(e={},m,i({},this.fields)),o(e,h,i({},this.errors)),e))},resetForm:function(){this.submit=!1},schemaValid:function(){var e,n,t;return d.isArr(null===(e=this.schema)||void 0===e?void 0:e[v])&&(null===(n=this.schema)||void 0===n||null===(t=n[v])||void 0===t?void 0:t.length)},showRow:function(e){return d.isArr(e)?this.showCols(e):this.showCol(e)},showCols:function(e){var n=this;return e.length&&e.some((function(e){return n.showCol(e)}))},showCol:function(e){return this.componentName(e)&&!this.fieldHidden(e)},slotProps:function(e){return d.isArr(e)?e.map((function(e){return e.model})):[e.model]},componentProps:function(e){var n,t=this.componentName(e),r=this.componentData(t),l=null==r?void 0:r.errorProp;return i(i(i({},l?o({},l,this.errors[e.model]):{}),e.vBind),{},{type:(null==e||null===(n=e.vBind)||void 0===n?void 0:n.type)||_.text})},removeAllErrors:function(){var e=this;Object.keys(this.errors).forEach((function(n){e.errors[n]=""}))},setError:function(e,n,t){d.isBool(n)&&n||!d.isBool(n)&&!n?this.errors[e]=t:this.errors[e]=n},componentData:function(e){return this.components.find((function(n){return(null==n?void 0:n.name)===e}))},typeCoercion:function(e){var n;Number.isNaN(Number(this.fields[e.model]))&&(null==e||null===(n=e.vBind)||void 0===n?void 0:n.type)===_.number&&this.fields[e.model]&&(this.fields[e.model]=Number(this.fields[e.model]))},componentEvents:function(e){return d.isObj(null==e?void 0:e[y])?null==e?void 0:e[y]:{}},componentName:function(e){var n,t,o=(null==e||null===(n=e.vBind)||void 0===n?void 0:n.type)||_.text,r=this.components.find((function(e){return e.types.includes(o)})),i=(null==e||null===(t=e.vBind)||void 0===t?void 0:t.is)||(null==r?void 0:r.name);return i},fieldConf:function(e){return this.allFieldsFlatObj[e]},fieldDisabled:function(e){var n,t=!(!(null==e?void 0:e.vBind)||!(w.disabled in e.vBind))&&(null===(n=e.vBind)||void 0===n?void 0:n[w.disabled]);return this.disabled||t},fieldRequired:function(e){var n;return!!(null==e?void 0:e[S])||!(!(null==e?void 0:e.vBind)||!(w.required in e.vBind))&&Boolean(null==e||null===(n=e.vBind)||void 0===n?void 0:n[w.required])},fieldHidden:function(e){var n;return!(!(null==e?void 0:e.vBind)||!(w.hidden in e.vBind))&&(null===(n=e.vBind)||void 0===n?void 0:n[w.hidden])},runRules:function(e,n){var t,o,r=u(e);try{for(r.s();!(o=r.n()).done;){var i=o.value;if(!(t=d.isFunc(i)?d.handleFunc(i,n):i))break}}catch(e){r.e(e)}finally{r.f()}return t},fieldValidation:function(e){var n=this.fieldRequired(e),t=this.submit||(null==e?void 0:e[p])||this.globalAv?this.runRules(null==e?void 0:e[S],this.fields[e.model]):"";return n?this.setError(e.model,t,""):this.submit||this.setError(e.model,t,""),this.logs&&this.submit&&console.log(e.model,{value:this.fields[e.model],valid:!t,required:n,error:t}),t},validate:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n||!t){var o={};Object.values(this.allFieldsFlatObj).forEach((function(n){var t=e.fieldValidation(n);o[n.model]=!t||!e.fieldRequired(n)}));var r=Object.keys(o).find((function(e){return!o[e]}));return{validationsStatus:o,submitFail:r}}var i=n[p]||this.globalAv,l=n[b]||this.globalAvDelay;i&&l?this.debounceValidateField(l)(n):this.fieldValidation(n)},handleSubmit:function(){var e,n=this;return(e=regeneratorRuntime.mark((function e(){var t,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.submit=!0,t=n.validate(),o=t.validationsStatus,r=t.submitFail,n.logs&&console.log("form validations:",o),!r){e.next=8;break}return n.resetForm(),e.next=7,n.onSubmitFail();case 7:return e.abrupt("return");case 8:return e.next=10,n.onSubmit();case 10:n.resetForm();case 11:case"end":return e.stop()}}),e)})),function(){var n=this,o=arguments;return new Promise((function(r,i){var l=e.apply(n,o);function u(e){t(l,r,i,u,s,"next",e)}function s(e){t(l,r,i,u,s,"throw",e)}u(void 0)}))})()}}},void 0,!1,void 0,!1,void 0,void 0,void 0),C=function(e){C.installed||(C.installed=!0,e.component("FormGeneratorVue",g))},A={install:C},F=null;return"undefined"!=typeof window?F=window.Vue:"undefined"!=typeof global&&(F=global.Vue),F&&F.use(A),g.install=C,e.default=g,e}({});