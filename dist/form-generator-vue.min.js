var FormGeneratorVue=function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t,r,n,o,i,l){try{var s=e[i](l),a=s.value}catch(e){return void r(e)}s.done?t(a):Promise.resolve(a).then(n,o)}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var l,s=e[Symbol.iterator]();!(n=(l=s.next()).done)&&(r.push(l.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}var c,d={props:{value:{type:Object,default:null,required:!1},onSubmit:{type:Function,required:!1,default:function(){console.error("submit handler not present")}},validationRules:{type:Object,required:!1,default:function(){return{}}},formComponents:{type:Array,required:!1,default:function(){return[]}},disabled:{type:Boolean,required:!1,default:!1},schema:{type:Object,default:function(){return{}}},classes:{type:Object,required:!1,default:function(){return{}}},onSubmitFail:{type:Function,required:!1,default:function(){console.warn("Form submit fail")}}}},f={isUndef:function(e){return void 0===e},isObjNotArr:function(e){return f.isArr(e)?e.every((function(e){return f.isObj(e)&&!f.isArr(e)})):f.isObj(e)&&!f.isArr(e)},isObj:function(e){return f.isArr(e)?e.every((function(e){return"object"===t(e)})):"object"===t(e)},isArr:function(e){return Array.isArray(e)},isFunc:function(e){return"function"==typeof e},isBool:function(e){return"boolean"==typeof e},isStr:function(e){return"string"==typeof e},throwError:function(e){throw new Error(e)},warn:function(e){console.warn(e)},hasProperty:function(e,t){return f.isArr(e)?e.every((function(e){return e in t})):e in t},handleFunc:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(f.isFunc(e))return e(t)},handleFuncOrBool:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=Boolean(e);return f.isFunc(e)&&(r=e(t)),r},debounce:function(e){return function(t){return function(r){clearTimeout(c),c=setTimeout((function(){clearTimeout(c),e(r)}),t)}}}},m={form:"fgv-form",header:"fgv-form__header",body:"fgv-form__body",footer:"fgv-form__footer",row:"fgv-form__body__row",col:"fgv-form__body__row__col"},h={header:"header",footer:"footer",beforeComponent:function(e){return"".concat(e,"_before")},afterComponent:function(e){return"".concat(e,"_after")},beforeRow:"before-row",afterRow:"after-row",beforeCol:"before-col",afterCol:"after-col"},v="fields",p="activeValidation",b="activeValidationDelay",y="logs",S="values",_="errors",w=p,O=b,g="events",C="component",F="hide",A={text:"text",number:"number"},j={required:"required",disabled:"disabled"};function T(e,t,r,n,o,i,l,s,a,u){"boolean"!=typeof l&&(a=s,s=l,l=!1);const c="function"==typeof r?r.options:r;let d;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,o&&(c.functional=!0)),n&&(c._scopeId=n),i?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,a(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},c._ssrRegister=d):t&&(d=l?function(e){t.call(this,u(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,s(e))}),d)if(c.functional){const e=c.render;c.render=function(t,r){return d.call(r),e(t,r)}}else{const e=c.beforeCreate;c.beforeCreate=e?[].concat(e,d):[d]}return r}var R=T({render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("form",{class:[e.CLASS.form],on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[r("div",{class:[e.CLASS.header]},[e._t(e.SLOT.header)],2),e._v(" "),r("div",{class:[e.CLASS.body]},[e._l(e.fieldsSchema,(function(t,n){return[e.showRow(t)?e._t(e.SLOT.beforeRow,null,{model:e.getModelFromSchema(t)}):e._e(),e._v(" "),e.showRow(t)?r("div",{key:n,class:[e.CLASS.row,e.classes.row]},[e.UTILS.isArr(t)?[e._l(t,(function(t){return[e.showCol(t)?e._t(e.SLOT.beforeCol,null,{model:e.getModelFromSchema(t)}):e._e(),e._v(" "),e.showCol(t)?r("div",{key:t.model,class:[e.CLASS.col,t.model,e.classes.col]},[e._t(e.SLOT.beforeComponent(t.model)),e._v(" "),r(e.componentToRender(t),e._g(e._b({tag:"component",model:{value:e.fields[t.model],callback:function(r){e.$set(e.fields,t.model,r)},expression:"fields[s.model]"}},"component",e.componentProps(t),!1),e.componentEvents(t)),[e._t(t.model)],2),e._v(" "),e._t(e.SLOT.afterComponent(t.model))],2):e._e(),e._v(" "),e.showCol(t)?e._t(e.SLOT.afterCol,null,{model:e.getModelFromSchema(t)}):e._e()]}))]:[e.showCol(t)?e._t(e.SLOT.beforeCol,null,{model:e.getModelFromSchema(t)}):e._e(),e._v(" "),e.showCol(t)?r("div",{key:t.model,class:[e.CLASS.col,t.model,e.classes.col]},[e._t(e.SLOT.beforeComponent(t.model)),e._v(" "),r(e.componentToRender(t),e._g(e._b({tag:"component",model:{value:e.fields[t.model],callback:function(r){e.$set(e.fields,t.model,r)},expression:"fields[schema.model]"}},"component",e.componentProps(t),!1),e.componentEvents(t)),[e._t(t.model)],2),e._v(" "),e._t(e.SLOT.afterComponent(t.model))],2):e._e(),e._v(" "),e.showCol(t)?e._t(e.SLOT.afterCol,null,{model:e.getModelFromSchema(t)}):e._e()]],2):e._e(),e._v(" "),e.showRow(t)?e._t(e.SLOT.afterRow,null,{model:e.getModelFromSchema(t)}):e._e()]}))],2),e._v(" "),r("div",{class:e.CLASS.footer},[e._t(e.SLOT.footer)],2)])},staticRenderFns:[]},void 0,{mixins:[d,{methods:{getModelFromSchema:function(e){return f.isArr()?e.map((function(e){return e.model})):e.model}}}],data:function(){var e=this,t={},r={},n=function(n){t[n]=e.vModelValid(!0)&&S in e.value&&e.value[S][n]||"",r[n]=e.vModelValid(!0)&&_ in e.value&&e.value[_][n]||""};if(v in this.schema&&f.isArr(this.schema.fields)&&this.schema.fields.length){var o,i=u(this.schema.fields);try{for(i.s();!(o=i.n()).done;){var l=o.value;if(f.isArr(l)){var s,a=u(l);try{for(a.s();!(s=a.n()).done;){n(s.value.model)}}catch(e){a.e(e)}finally{a.f()}}else n(l.model)}}catch(e){i.e(e)}finally{i.f()}}return{fields:t,errors:r,submit:!1}},computed:{SLOT:function(){return h},CLASS:function(){return m},UTILS:function(){return f},avGlobal:function(){return p in this.schema&&this.schema[p]},avDelayGlobal:function(){var e=b in this.schema&&this.schema[b]&&!isNaN(this.schema[b]);return!(!this.avGlobal||!e)&&this.schema[b]},logs:function(){return y in this.schema&&this.schema[y]},fieldsSchema:function(){return v in this.schema&&f.isArr(this.schema[v])?this.schema[v]:[]},fieldsSchemaFlat:function(){var e,t=[],r=u(this.fieldsSchema);try{for(r.s();!(e=r.n()).done;){var n=e.value;if(f.isArr(n)){var o,i=u(n);try{for(i.s();!(o=i.n()).done;){var l=o.value;t.push(l)}}catch(e){i.e(e)}finally{i.f()}}else t.push(n)}}catch(e){r.e(e)}finally{r.f()}return t},fieldsSchemaMap:function(){var e=this.fieldsSchemaFlat.map((function(e){return[e.model,e]}));return Object.fromEntries(e)},deValidateField:function(){var e=this;return f.debounce((function(t){e.validateField(t)}))}},watch:{disabled:{handler:function(e){e&&this.removeAllErrors()}},value:{handler:function(){if(this.vModelValid())for(var e in this.value[S])this.fields[e]=this.value[S][e],this.errors[e]=this.value[_][e]},deep:!0},fields:{handler:function(){this.rmUnwantedModels(),this.$emit("input",{values:this.fields,errors:this.errors})},deep:!0,immediate:!0}},created:function(){var e=this,r=function(r){var n=e.findSchema(r);e.$watch("fields.".concat(r),(function(e,r){this.typeCoercion(n),e==r&&t(e)!==t(r)||this.validate(n,!0)}),{deep:!0,immediate:n.rules&&n.rules.immediate})};for(var n in this.fields)r(n)},methods:{validate:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t||!r){var n={};Object.values(this.fieldsSchemaMap).forEach((function(t){n[t.model]=e.validateField(t)||!e.fieldRequired(t)}));var o=Object.values(n).find((function(e){return!e}))||Object.values(this.errors).find((function(e){return e}));return[n,o]}var i=t&&t[O]||this.avDelayGlobal;i?this.deValidateField(i)(t):this.validateField(t)},showRow:function(e){return this.hasFieldsToRender(e)||this.showCol(e)},hasFieldsToRender:function(e){var t=this;return f.isArr(e)&&e.length&&e.some((function(e){return!t.fieldHidden(e)}))},showCol:function(e){return this.componentToRender(e)&&!this.fieldHidden(e)},vModelValid:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.value&&f.isObjNotArr(this.value),r=S in this.value&&f.isObjNotArr(this.value[S]),n=_ in this.value&&f.isObjNotArr(this.value[_]);return e?t&&r:t&&r&&n},resetFormState:function(){this.submit=!1},removeAllErrors:function(){for(var e in this.errors)this.errors[e]=""},setError:function(e,t){var r=this.errors[e];r===t||f.isObj(t,r)&&JSON.stringify(t)===JSON.stringify(r)||(this.errors[e]=t)},findComponentData:function(e){return this.formComponents.find((function(t){return t&&t.name===e}))},componentProps:function(e){var t,r=this.componentToRender(e),o=this.findComponentData(r),l=e&&e.rules&&e.rules.errorProp||o&&o.errorProp||"error";return i(i({},e.props),{},(n(t={},l,this.errors[e.model]),n(t,"ref",e.model),n(t,"type",e.type||A.text),n(t,"disabled",this.fieldDisabled(e)),n(t,"required",this.fieldRequired(null,e)),t))},typeCoercion:function(e){isNaN(this.fields[e.model])&&e&&e.type===A.number&&this.fields[e.model]&&(this.fields[e.model]=Number(this.fields[e.model]))},componentEvents:function(e){return g in e&&f.isFunc(e[g])?f.handleFunc(e[g]):{}},componentToRender:function(e){var t=e.type||A.text;if(C in e&&e[C]&&f.isStr(e[C]))return e.component;var r=this.formComponents.find((function(e){return e.type.includes(t)})),n=r&&r.name;return!n&&console.error('Component cannot be rendered. Component for type "'.concat(t,'" is not found in form-components.')),n},findSchema:function(e){return this.fieldsSchemaMap[e]},fieldDisabled:function(e){var t=!!(e&&e.props&&j.disabled in e.props)&&f.handleFuncOrBool(e.props[j.disabled]);return!(!this.disabled&&!t)},fieldRequired:function(e){var t=!(e&&e.props&&j.required in e.props)||f.handleFuncOrBool(e.props[j.required]);return!(!e||this.fieldDisabled(e)||this.fieldHidden(e))&&t},rmUnwantedModels:function(){var e=this;Object.keys(this.fields).filter((function(t){return!e.fieldsSchemaFlat.find((function(e){var r=e.model;return t===r}))})).forEach((function(t){delete e.fields[t],delete e.errors[t]}))},fieldHidden:function(e){var t=F in e&&f.handleFuncOrBool(e[F]);return t},validateField:function(e){var r=this.fieldRequired(e),n=e.rules&&e.rules.validator,o=w in e?Boolean(e[w]):this.avGlobal,i=!this.submit&&!o||(f.handleFunc(n)||""),l=!i||Boolean(i);return(r||!this.submit)&&this.setError(e.model,i),this.logs&&console.log({model:e.model,value:this.fields[e.model],type:t(this.fields[e.model]),valid:l,required:r,error:i}),l},handleSubmit:function(){var e,t=this;return(e=regeneratorRuntime.mark((function e(){var r,n,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.submit=!0,t.rmUnwantedModels(),r=t.validate(),n=l(r,2),o=n[0],i=n[1],t.logs&&(console.log("form data:",t.fields),console.log("form validations:",o)),!i){e.next=8;break}return t.resetFormState(),t.onSubmitFail(),e.abrupt("return");case 8:return e.next=10,t.onSubmit();case 10:t.resetFormState();case 11:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(o,i){var l=e.apply(t,n);function s(e){r(l,o,i,s,a,"next",e)}function a(e){r(l,o,i,s,a,"throw",e)}s(void 0)}))})()}}},void 0,!1,void 0,!1,void 0,void 0,void 0),L=function(e){L.installed||(L.installed=!0,e.component("FormGeneratorVue",R))},E={install:L},M=null;return"undefined"!=typeof window?M=window.Vue:"undefined"!=typeof global&&(M=global.Vue),M&&M.use(E),R.install=L,e.default=R,e}({});