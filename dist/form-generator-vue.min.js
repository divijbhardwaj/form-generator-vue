var FormGeneratorVue=function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t,n,o,r,i,s){try{var l=e[i](s),a=l.value}catch(e){return void n(e)}l.done?t(a):Promise.resolve(a).then(o,r)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var s,l=e[Symbol.iterator]();!(o=(s=l.next()).done)&&(n.push(s.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function u(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw i}}}}function c(e){return"function"==typeof e}var d=function(e,t,n,o,r,i){var s=function(e){return""===String(e).trim()||![!1,0].includes(e)&&!e?"FIELD_IS_EMPTY":""}(t),l=o.COMMON_VALIDATORS,a=!(!l||!Object.keys(l).length),f=o[e]||o[n.type]||void 0;if("FIELD_IS_EMPTY"!==s){if(a)for(var u in l)!c(l[u])&&console.error("".concat(u," is not a function.")),s=l[u](t,n,r),void 0===s&&console.error("".concat(u," return error string if field is invalid, return empty string when success"));return c(f)?m(s=f(t,n,r)):(e in o&&console.error("".concat(f," is not a function.")),m(s))}return m(s=i?"Required":"")};function m(e){return""!==e?[!1,e]:[!0,""]}function p(e,t,n,o,r,i,s,l,a,f){"boolean"!=typeof s&&(a=l,l=s,s=!1);const u="function"==typeof n?n.options:n;let c;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,r&&(u.functional=!0)),o&&(u._scopeId=o),i?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,a(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},u._ssrRegister=c):t&&(c=s?function(e){t.call(this,f(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,l(e))}),c)if(u.functional){const e=u.render;u.render=function(t,n){return c.call(n),e(t,n)}}else{const e=u.beforeCreate;u.beforeCreate=e?[].concat(e,c):[c]}return n}var h=p({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{staticClass:"generated-form",on:{submit:function(t){return t.preventDefault(),e.submitForm(t)}}},[n("div",{staticClass:"generated-form__header"},[e._t("header")],2),e._v(" "),e.formEditable?n("div",{staticClass:"generated-form__body"},[e._l(e.fieldsConfig,(function(t){return[e._t("sectionLabel",null,{fieldConfig:t,fieldsConfigFlat:e.fieldsConfig_FLAT}),e._v(" "),n("div",e._b({key:t.model,staticClass:"generated-form__body__row"},"div",{class:e.classes.row},!1),[e.isArr(t)?[e._l(t,(function(t){return[n("div",e._b({directives:[{name:"show",rawName:"v-show",value:e.fieldVisible(t)&&e.computedComponent(t),expression:"fieldVisible(subFieldConfig) && computedComponent(subFieldConfig)"}],key:t.model,staticClass:"generated-form__body__row__col",class:"col-"+t.model},"div",{class:e.classes.col},!1),[[e._t(t.model+"_before"),e._v(" "),n(e.computedComponent(t),e._g(e._b({key:t.model,ref:t.model,refInFor:!0,tag:"component",attrs:{type:t.type||"text"},model:{value:e.fields[t.model],callback:function(n){e.$set(e.fields,t.model,"string"==typeof n?n.trim():n)},expression:"fields[subFieldConfig.model]"}},"component",e.bindProps(t),!1),e.bindEvents(t))),e._v(" "),e._t(t.model+"_after")]],2)]}))]:[n("div",e._b({directives:[{name:"show",rawName:"v-show",value:e.fieldVisible(t)&&e.computedComponent(t),expression:"fieldVisible(fieldConfig) && computedComponent(fieldConfig)"}],staticClass:"generated-form__body__row__col",class:"col-"+t.model},"div",{class:e.classes.col},!1),[[e._t(t.model+"_before"),e._v(" "),n(e.computedComponent(t),e._g(e._b({key:t.model,ref:t.model,refInFor:!0,tag:"component",attrs:{type:t.type||"text"},model:{value:e.fields[t.model],callback:function(n){e.$set(e.fields,t.model,"string"==typeof n?n.trim():n)},expression:"fields[fieldConfig.model]"}},"component",e.bindProps(t),!1),e.bindEvents(t))),e._v(" "),e._t(t.model+"_after")]],2)]],2)]}))],2):e._e(),e._v(" "),e.formEditable?e._e():e._t("disabled",null,{fieldsConfigFlat:e.fieldsConfig_FLAT}),e._v(" "),e._t("agreement"),e._v(" "),e._t("actions"),e._v(" "),n("div",{staticClass:"generated-form__footer"},[e._t("footer")],2)],2)},staticRenderFns:[]},void 0,{props:{submitHandler:{type:Function,required:!1,default:function(){console.error("submit handler not present")}},formRules:{type:Object,required:!1,default:function(){return{}}},formComponents:{type:Array,required:!1,default:function(){return[]}},formEditable:{type:Boolean,required:!1,default:!0},validationConfig:{type:Object,required:!1,default:function(){return{}}},formConfig:{type:Object,default:function(){return{}}},classes:{type:Object,required:!1,default:function(){return{}}},handleSubmitFail:{type:Function,required:!1,default:function(){console.warn("Form submit fail")}}},data:function(){var e={},t={};function n(n){e=i(i({},e),{},o({},n.model,"value"in n?n.value:"")),t=i(i({},t),{},o({},n.model,""))}if("fields"in this.formConfig){var r,s=u(this.formConfig.fields);try{for(s.s();!(r=s.n()).done;){var l=r.value;if(this.isArr(l)){var a,f=u(l);try{for(f.s();!(a=f.n()).done;){n(a.value)}}catch(e){f.e(e)}finally{f.f()}}else n(l)}}catch(e){s.e(e)}finally{s.f()}}return{fields:e,errors:t,loading:!1,submit:!1}},computed:{helperComponent:function(){return"_formHelper"},activeValidation:function(){return"activeValidation"in this.formConfig&&this.formConfig.activeValidation},logs:function(){return"logs"in this.formConfig&&this.formConfig.logs},fieldsConfig:function(){return"fields"in this.formConfig&&this.formConfig.fields.length?this.formConfig.fields:[]},fieldsConfig_FLAT:function(){var e,t=[],n=u(this.fieldsConfig);try{for(n.s();!(e=n.n()).done;){var o=e.value;t=this.isArr(o)?[].concat(l(t),l(o)):[].concat(l(t),[o])}}catch(e){n.e(e)}finally{n.f()}return t}},watch:{formEditable:{handler:function(e){!e&&this.removeAllErrors()}}},created:function(){var e=this;this.$emit("setFormContext",this);var n=function(n){e.$watch("fields.".concat(n),(function(e,o){this.convertToNumber(n),this.updateHelpers(n,e),e==o&&t(e)!==t(o)||this.validateField(n)}))};for(var o in this.fields)n(o)},methods:{resetFormState:function(){this.submit=!1,this.loading=!1},removeAllErrors:function(){for(var e in this.errors)this.errors[e]=""},showErrors:function(e,t){this.errors[e]=t},isHelperComponent:function(e){return e.includes(this.helperComponent)},updateHelpers:function(e,t){var n=t;if(this.isHelperComponent(e)){var o=e.split(this.helperComponent)[0];o in this.fields&&(this.fields[o]=n)}else if("".concat(e).concat(this.helperComponent)in this.fields){var r="".concat(e).concat(this.helperComponent);this.fields[r]=n}},setDefaultFieldValue:function(e){this.fields[e.model]="value"in e?e.value:""},fieldVisible:function(e){var t=!("show"in e)||("function"==typeof e.show?e.show(this):Boolean(e.show));return!t&&this.setDefaultFieldValue(e),t},bindProps:function(e){var t,n=this.computedComponent(e),r=this.formComponents.find((function(e){return e.component.name===n})),s=(e.errorProp?{component:{errorProp:e.errorProp}}:r||{component:{errorProp:"errorMessage"}}).component.errorProp;return i(i({},e.props),{},(o(t={},s,this.errors[e.model]),o(t,"disabled",this.fieldDisabled(e)),t))},findFieldConfig:function(e){return this.fieldsConfig_FLAT.find((function(t){return t.model===e}))},convertToNumber:function(e){var t=this.findFieldConfig(e);t&&"number"===t.type&&this.fields[e]&&(this.fields[e]=Number(this.fields[e]))},bindEvents:function(e){return"triggers"in e&&this.isFunc(e.triggers)?e.triggers(this):{}},computedComponent:function(e){var t=e.type||"text";if("component"in e)return e.component;var n=(this.formComponents.find((function(e){return e.type.includes(t)}))||{component:{name:""}}).component.name;return!n&&console.error('Component cannot be rendered. Component for type "'.concat(t,'" is not found in form-components.')),n},fieldDisabled:function(e){var t=!(!e.props||!("disabled"in e.props))&&(this.isFunc(e.props.disabled)?e.props.disabled(this):Boolean(e.props.disabled));return!(this.formEditable&&!t)},fieldRequired:function(e){var t=this.findFieldConfig(e),n=this.isFunc(t.required)?t.required(this):Boolean(t.required);return!(!t||this.fieldDisabled(t)||!this.fieldVisible(t))&&(this.isHelperComponent(e)?"required"in t&&n:!("required"in t)||n)},validateField:function(e){var n=this.fieldRequired(e),o=this.findFieldConfig(e).rules||{},r=s(this.submit||this.activeValidation?d(e,this.fields[e],o,this.formRules,i({},this.fields),this.submit):[!0,""],2),l=r[0],a=r[1];return(n||!this.submit)&&this.showErrors(e,a),this.logs&&console.log("model:".concat(e,"\n"),"value:".concat(this.fields[e],"\n"),"type:".concat(t(this.fields[e]),"\n"),"isValid:".concat(l,"\n"),"required:".concat(n,"\n"),"errorMessage:".concat(a)),l},submitForm:function(){var e,t=this;return(e=regeneratorRuntime.mark((function e(){var n,o,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.loading=!0,t.submit=!0,n=[],Object.keys(t.fields).forEach((function(e){n=[].concat(l(n),[[e,t.validateField(e)]])})),o=n.find((function(e){var n=s(e,2),o=n[0],r=n[1];return t.fieldRequired(o)&&!1===r}))||[""],r=s(o,1),i=r[0],t.logs&&console.log("fields data",t.fields),console.log("validations status:",n),!i){e.next=12;break}return t.handleSubmitFail(t.fields),t.resetFormState(),e.abrupt("return");case 12:return console.log("Form is valid. calling submit handler.\n"),e.next=15,t.submitHandler(t.fields);case 15:t.resetFormState();case 16:case"end":return e.stop()}}),e)})),function(){var t=this,o=arguments;return new Promise((function(r,i){var s=e.apply(t,o);function l(e){n(s,r,i,l,a,"next",e)}function a(e){n(s,r,i,l,a,"throw",e)}l(void 0)}))})()},scrollToComponent:function(e){var t=this.findFieldConfig(e),n=this.computedComponent(t);if(this.logs&&console.log("scroll to:","".concat(n?e:"".concat(e,"(component not found)"))),n){var o=e,r=this.$refs[o][0].$el;r&&r.scrollIntoView({behavior:"smooth"})&&r.focus()}},isUndef:function(e){return void 0===e},isArr:function(e){return Array.isArray(e)},isFunc:function(e){return"function"==typeof e},isBool:function(e){return"boolean"==typeof e},throwError:function(e){throw new Error(e)},warn:function(e){console.warn(e)}}},"data-v-5ed5932e",!1,void 0,!1,void 0,void 0,void 0),b=function(e){b.installed||(b.installed=!0,e.component("FormGeneratorVue",h))},v={install:b},y=null;return"undefined"!=typeof window?y=window.Vue:"undefined"!=typeof global&&(y=global.Vue),y&&y.use(v),h.install=b,e.default=h,e}({});