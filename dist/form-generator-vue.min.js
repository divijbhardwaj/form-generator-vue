var FormGeneratorVue=function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t,n,r,i,o,s){try{var l=e[o](s),a=l.value}catch(e){return void n(e)}l.done?t(a):Promise.resolve(a).then(r,i)}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var s,l=e[Symbol.iterator]();!(r=(s=l.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=l(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}var c={props:{value:{type:Object,default:null,required:!1},onSubmit:{type:Function,required:!1,default:function(){console.error("submit handler not present")}},validationRules:{type:Object,required:!1,default:function(){return{}}},formComponents:{type:Array,required:!1,default:function(){return[]}},editable:{type:Boolean,required:!1,default:!0},schema:{type:Object,default:function(){return{}}},classes:{type:Object,required:!1,default:function(){return{}}},onSubmitFail:{type:Function,required:!1,default:function(){console.warn("Form submit fail")}}}},f={isUndef:function(e){return void 0===e},isObjNotArr:function(e){return f.isArr(e)?e.every((function(e){return f.isObj(e)&&!f.isArr(e)})):f.isObj(e)&&!f.isArr(e)},isObj:function(e){return"object"===t(e)},isArr:function(e){return Array.isArray(e)},isFunc:function(e){return"function"==typeof e},isBool:function(e){return"boolean"==typeof e},isStr:function(e){return"string"==typeof e},throwError:function(e){throw new Error(e)},warn:function(e){console.warn(e)},hasProperty:function(e,t){return f.isArr(e)?e.every((function(e){return e in t})):e in t},handlefuncAndBool:function(e,t){var n=Boolean(e);return f.isFunc(e)&&(n=e(t)),n}},d=[!0,""];function h(e,t,n,r,i,o){var s,l=(s=t,""===String(s).trim()||![!1,0].includes(s)&&!s?"FIELD_IS_EMPTY":""),a="emptyErr"in n?n.emptyErr:"Required",u=r.FILTER,c=n.validator||r[e];if("FIELD_IS_EMPTY"!==l){if(f.isFunc(u)){if(""!==(l=u(t,n,i)))return m(l)}else!f.isUndef(u)&&console.error("filter ".concat(u," is not a function."));return f.isFunc(c)?m(l=c(t,n,i)):(!f.isUndef(c)&&console.error("validator ".concat(c," is not a function.")),m(l))}return m(l=o?a:"")}function m(e){return""!==e?[!1,e]:d}function v(e,t,n,r,i,o,s,l,a,u){"boolean"!=typeof s&&(a=l,l=s,s=!1);const c="function"==typeof n?n.options:n;let f;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),r&&(c._scopeId=r),o?(f=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,a(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=f):t&&(f=s?function(e){t.call(this,u(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,l(e))}),f)if(c.functional){const e=c.render;c.render=function(t,n){return f.call(n),e(t,n)}}else{const e=c.beforeCreate;c.beforeCreate=e?[].concat(e,f):[f]}return n}var p=v({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{staticClass:"generated-form",on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[n("div",{staticClass:"generated-form__header"},[e._t("header")],2),e._v(" "),e.editable?n("div",{staticClass:"generated-form__body"},[e._t("body-start"),e._v(" "),e._l(e.fieldsConfig,(function(t,r){return[e._t("sectionLabel",null,{fieldConfig:t,fieldsConfigFlat:e.fieldsConfigFlat}),e._v(" "),e.UTILS.isArr(t)||e.fieldIsVisible(t)&&e.componentToRender(t)?n("div",{key:r,class:["generated-form__body__row",e.classes.row]},[e.UTILS.isArr(t)?[e._l(t,(function(t){return[n("div",{directives:[{name:"show",rawName:"v-show",value:e.fieldIsVisible(t)&&e.componentToRender(t),expression:"\n                fieldIsVisible(subFieldConfig) &&\n                componentToRender(subFieldConfig)\n              "}],key:t.model,class:["generated-form__body__row__col","col-"+t.model,e.classes.col]},[[e._t(t.model+"_before"),e._v(" "),n(e.componentToRender(t),e._g(e._b({tag:"component",model:{value:e.fields[t.model],callback:function(n){e.$set(e.fields,t.model,n)},expression:"fields[subFieldConfig.model]"}},"component",e.componentProps(t),!1),e.componentEvents(t)),[e._t(""+t.model)],2),e._v(" "),e._t(t.model+"_after")]],2)]}))]:[n("div",{key:t.model,class:["generated-form__body__row__col","col-"+t.model,e.classes.col]},[[e._t(t.model+"_before"),e._v(" "),n(e.componentToRender(t),e._g(e._b({tag:"component",model:{value:e.fields[t.model],callback:function(n){e.$set(e.fields,t.model,n)},expression:"fields[fieldConfig.model]"}},"component",e.componentProps(t),!1),e.componentEvents(t)),[e._t(""+t.model)],2),e._v(" "),e._t(t.model+"_after")]],2)]],2):e._e()]})),e._v(" "),e._t("body-end")],2):e._e(),e._v(" "),e.editable?e._e():e._t("uneditable",null,{fieldsConfigFlat:e.fieldsConfigFlat}),e._v(" "),n("div",{staticClass:"generated-form__footer"},[e._t("footer")],2)],2)},staticRenderFns:[]},void 0,{mixins:[c],data:function(){var e=this,t={},n={},r=function(r){t[r]=e.vModelValid(!0)&&"values"in e.value?e.value.values[r]:"",n[r]=e.vModelValid(!0)&&"errors"in e.value?e.value.errors[r]:""};if("fields"in this.schema&&f.isArr(this.schema.fields)&&this.schema.fields.length){var i,o=u(this.schema.fields);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(f.isArr(s)){var l,a=u(s);try{for(a.s();!(l=a.n()).done;){r(l.value.model)}}catch(e){a.e(e)}finally{a.f()}}else r(s.model)}}catch(e){o.e(e)}finally{o.f()}}return{fields:t,errors:n,submit:!1}},computed:{UTILS:function(){return f},activeValidation:function(){return"activeValidation"in this.schema&&this.schema.activeValidation},activeValidationDelay:function(){var e="activeValidationDelay"in this.schema&&this.schema.activeValidationDelay&&!isNaN(this.schema.activeValidationDelay);return!(!this.activeValidation||!e)&&this.schema.activeValidationDelay},logs:function(){return"logs"in this.schema&&this.schema.logs},fieldsConfig:function(){return"fields"in this.schema&&this.schema.fields.length?this.schema.fields:[]},fieldsConfigFlat:function(){var e,t=[],n=u(this.fieldsConfig);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(f.isArr(r)){var i,o=u(r);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.push(s)}}catch(e){o.e(e)}finally{o.f()}}else t.push(r)}}catch(e){n.e(e)}finally{n.f()}return t},debounceValidateField:function(){var e=this;return this.debounce((function(t){e.validateField(t)}),this.activeValidationDelay)}},watch:{editable:{handler:function(e){!e&&this.removeAllErrors()}},value:{handler:function(){if(this.vModelValid())for(var e in this.value.values)this.fields[e]=this.value.values[e],this.errors[e]=this.value.errors[e]},deep:!0},fields:{handler:function(){this.removeUnwantedFields(),this.$emit("input",{values:this.fields,errors:this.errors})},deep:!0,immediate:!0}},created:function(){var e=this;this.$emit("setFormContext",this);var n=function(n){e.$watch("fields.".concat(n),(function(e,r){this.convertToNumber(n),this.updateHelpers(n,e),e==r&&t(e)!==t(r)||(this.activeValidationDelay?this.debounceValidateField(n):this.validateField(n))}))};for(var r in this.fields)n(r)},methods:{vModelValid:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.value&&f.isObjNotArr(this.value);if(e)return t&&"values"in this.value;var n=t&&f.hasProperty(["values","errors"],this.value);return n&&f.isObjNotArr([this.value.values,this.value.errors])},removeUnwantedFields:function(){var e=this;Object.keys(this.fields).filter((function(t){return!e.fieldsConfigFlat.find((function(e){return e.model===t}))})).forEach((function(t){delete e.fields[t],delete e.errors[t]}))},debounce:function(e,t){var n;return function(r){clearTimeout(n),n=setTimeout((function(){clearTimeout(n),e(r)}),t)}},resetFormState:function(){this.submit=!1},removeAllErrors:function(){for(var e in this.errors)this.errors[e]=""},setError:function(e,t){this.errors[e]=t},isHelperComponent:function(e){return e.includes("_helper")},updateHelpers:function(e,t){var n=t;if(this.isHelperComponent(e)){var r=s(e.split("_helper"),1)[0];r in this.fields&&(this.fields[r]=n)}else if("".concat(e).concat("_helper")in this.fields){var i="".concat(e).concat("_helper");this.fields[i]=n}},setDefaultFieldValue:function(e){this.fields[e.model]="value"in e?e.value:""},fieldIsVisible:function(e){var t=!("show"in e)||f.handlefuncAndBool(e.show,this);return!t&&this.setDefaultFieldValue(e),t},componentProps:function(e){var t,n=this.componentToRender(e),i=this.formComponents.find((function(e){return e.compData&&e.compData.name===n})),s=e.errorProp||i.compData.errorProp||"error";return o(o({},e.props),{},(r(t={},s,this.errors[e.model]),r(t,"ref",e.model),r(t,"key",e.model),r(t,"type",e.type||"text"),r(t,"disabled",this.fieldIsDisabled(e)),r(t,"required",this.fieldIsRequired(null,e)),t))},findFieldConfig:function(e){return this.fieldsConfigFlat.find((function(t){return t.model===e}))},convertToNumber:function(e){var t=this.findFieldConfig(e);t&&"number"===t.type&&this.fields[e]&&(this.fields[e]=Number(this.fields[e]))},componentEvents:function(e){return"triggers"in e&&f.isFunc(e.triggers)?e.triggers(this):{}},componentToRender:function(e){var t=e.type||"text";if("component"in e&&e.component&&f.isStr(e.component))return e.component;var n=this.formComponents.find((function(e){return e.type.includes(t)})),r=n&&n.compData?n.compData.name:"";return!r&&console.error('Component cannot be rendered. Component for type "'.concat(t,'" is not found in form-components.')),r},fieldIsDisabled:function(e){var t=!!(e&&e.props&&"disabled"in e.props)&&f.handlefuncAndBool(e.props.disabled,this);return!(this.editable&&!t)},fieldIsRequired:function(e,t){var n=e||t.model,r=t||this.findFieldConfig(n),i=r&&r.props&&"required"in r.props?f.handlefuncAndBool(r.props.required,this):!this.isHelperComponent(n);return!(!r||this.fieldIsDisabled(r)||!this.fieldIsVisible(r))&&i},validateField:function(e){var n=this.findFieldConfig(e),r=this.fieldIsRequired(null,n),i=n.rules||{},l="activeValidation"in n?Boolean(n.activeValidation):this.activeValidation,a=s(this.submit||l?h(e,this.fields[e],i,this.validationRules,o({},this.fields),this.submit):[!0,""],2),u=a[0],c=a[1];return(r||!this.submit)&&this.setError(e,c),this.logs&&console.log("model:".concat(e,"\n"),"value:".concat(this.fields[e],"\n"),"type:".concat(t(this.fields[e]),"\n"),"valid:".concat(u,"\n"),"required:".concat(r,"\n"),"error:".concat(c)),u},handleSubmit:function(){var e,t=this;return(e=regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.submit=!0,n={},t.removeUnwantedFields(),Object.keys(t.fields).forEach((function(e){n[e]=t.validateField(e)||!t.fieldIsRequired(e)})),r=Object.keys(n).find((function(e){return!n[e]})),t.logs&&(console.log("form data:",t.fields),console.log("form validations:",n)),!r){e.next=10;break}return t.resetFormState(),t.onSubmitFail(t.fields),e.abrupt("return");case 10:return e.next=12,t.onSubmit(t.fields);case 12:t.resetFormState();case 13:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(i,o){var s=e.apply(t,r);function l(e){n(s,i,o,l,a,"next",e)}function a(e){n(s,i,o,l,a,"throw",e)}l(void 0)}))})()}}},void 0,!1,void 0,!1,void 0,void 0,void 0),b=function(e){b.installed||(b.installed=!0,e.component("FormGeneratorVue",p))},y={install:b},_=null;return"undefined"!=typeof window?_=window.Vue:"undefined"!=typeof global&&(_=global.Vue),_&&_.use(y),p.install=b,e.default=p,e}({});