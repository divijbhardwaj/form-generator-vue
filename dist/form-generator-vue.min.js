var FormGeneratorVue=function(e){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,n,o,t,r,i,l){try{var s=e[i](l),u=s.value}catch(e){return void o(e)}s.done?n(u):Promise.resolve(u).then(t,r)}function t(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function r(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}function i(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?r(Object(o),!0).forEach((function(n){t(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}var l,s={props:{value:{type:Object,default:null,required:!1},onSubmit:{type:Function,required:!1,default:function(){console.error("submit handler not present")}},components:{type:Array,required:!1,default:function(){return[]}},disabled:{type:Boolean,required:!1,default:!1},schema:{type:Object,default:function(){return{}}},classes:{type:Object,required:!1,default:function(){return{}}},onSubmitFail:{type:Function,required:!1,default:function(){console.warn("Form submit fail")}},activeValidation:{type:Boolean,required:!1,default:!1},activeValidationDelay:{type:Number,required:!1,default:0},logs:{type:Boolean,required:!1,default:!1}}},u={isUndef:function(e){return void 0===e},isObjNotArr:function(e){return u.isArr(e)?e.every((function(e){return u.isObj(e)&&!u.isArr(e)})):u.isObj(e)},isObj:function(e){return u.isArr(e)?e.every((function(e){return"object"===n(e)})):"object"===n(e)},isArr:function(e){return Array.isArray(e)},isFunc:function(e){return"function"==typeof e},isBool:function(e){return"boolean"==typeof e},isStr:function(e){return"string"==typeof e},throwError:function(e){throw new Error(e)},warn:function(e){console.warn(e)},hasProperty:function(e,n){return u.isArr(e)?e.every((function(e){return e in n})):e in n},handleFunc:function(e){if(u.isFunc(e))return e()},handleFuncOrBool:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=Boolean(e);return u.isFunc(e)&&(o=e(n)),o},debounce:function(e){return function(n){return function(o){clearTimeout(l),l=setTimeout((function(){clearTimeout(l),e(o)}),n)}}}},d={form:"fgv-form",header:"fgv-form__header",body:"fgv-form__body",footer:"fgv-form__footer",row:"fgv-form__body__row",col:"fgv-form__body__row__col"},a={header:"header",footer:"footer",beforeComponent:function(e){return"before-".concat(e)},afterComponent:function(e){return"after-".concat(e)},beforeRow:"before-row",afterRow:"after-row",beforeCol:"before-col",afterCol:"after-col"},c="fields",f="fields",v="errors",m="activeValidation",h="activeValidationDelay",p="vOn",b={text:"text",number:"number"},y={required:"required",disabled:"disabled",hidden:"hidden"},_="validation";function O(e,n,o,t,r,i,l,s,u,d){"boolean"!=typeof l&&(u=s,s=l,l=!1);const a="function"==typeof o?o.options:o;let c;if(e&&e.render&&(a.render=e.render,a.staticRenderFns=e.staticRenderFns,a._compiled=!0,r&&(a.functional=!0)),t&&(a._scopeId=t),i?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,u(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},a._ssrRegister=c):n&&(c=l?function(e){n.call(this,d(e,this.$root.$options.shadowRoot))}:function(e){n.call(this,s(e))}),c)if(a.functional){const e=a.render;a.render=function(n,o){return c.call(o),e(n,o)}}else{const e=a.beforeCreate;a.beforeCreate=e?[].concat(e,c):[c]}return o}var w=O({render:function(){var e=this,n=e.$createElement,o=e._self._c||n;return o("form",{class:[e.CLASS.form],on:{submit:function(n){return n.preventDefault(),e.handleSubmit(n)}}},[o("div",{class:[e.CLASS.header]},[e._t(e.SLOT.header)],2),e._v(" "),o("div",{class:[e.CLASS.body]},[e._l(e.allFieldsArray,(function(n,t){return[e.showRow(n)?e._t(e.SLOT.beforeRow,null,{models:e.slotProps(n)}):e._e(),e._v(" "),e.showRow(n)?o("div",{key:t,class:[e.CLASS.row,e.classes.row]},[e.UTILS.isArr(n)?[e._l(n,(function(n){return[e.showCol(n)?e._t(e.SLOT.beforeCol,null,{models:e.slotProps(n)}):e._e(),e._v(" "),e.showCol(n)?o("div",{key:n.model,class:[e.CLASS.col,n.model,e.classes.col]},[e._t(e.SLOT.beforeComponent(n.model)),e._v(" "),o(e.componentName(n),e._g(e._b({tag:"component",model:{value:e.fields[n.model],callback:function(o){e.$set(e.fields,n.model,o)},expression:"fields[subConf.model]"}},"component",e.componentProps(n),!1),e.componentEvents(n)),[e._t(n.model)],2),e._v(" "),e._t(e.SLOT.afterComponent(n.model))],2):e._e(),e._v(" "),e.showCol(n)?e._t(e.SLOT.afterCol,null,{models:e.slotProps(n)}):e._e()]}))]:[e.showCol(n)?e._t(e.SLOT.beforeCol,null,{models:e.slotProps(n)}):e._e(),e._v(" "),e.showCol(n)?o("div",{key:n.model,class:[e.CLASS.col,n.model,e.classes.col]},[e._t(e.SLOT.beforeComponent(n.model)),e._v(" "),o(e.componentName(n),e._g(e._b({tag:"component",model:{value:e.fields[n.model],callback:function(o){e.$set(e.fields,n.model,o)},expression:"fields[conf.model]"}},"component",e.componentProps(n),!1),e.componentEvents(n)),[e._t(n.model)],2),e._v(" "),e._t(e.SLOT.afterComponent(n.model))],2):e._e(),e._v(" "),e.showCol(n)?e._t(e.SLOT.afterCol,null,{models:e.slotProps(n)}):e._e()]],2):e._e(),e._v(" "),e.showRow(n)?e._t(e.SLOT.afterRow,null,{models:e.slotProps(n)}):e._e()]}))],2),e._v(" "),o("div",{class:e.CLASS.footer},[e._t(e.SLOT.footer)],2)])},staticRenderFns:[]},void 0,{mixins:[s],emits:["input"],data:function(){var e=this,n={},o={},t=this.schemaValid(),r=function(t){var r,i,l,s;n[t]=(null===(r=e.value)||void 0===r||null===(i=r[f])||void 0===i?void 0:i[t])||"",o[t]=(null===(l=e.value)||void 0===l||null===(s=l[v])||void 0===s?void 0:s[t])||""};return t&&this.schema[c].forEach((function(e){u.isArr(e)?e.forEach((function(e){r(e.model)})):r(e.model)})),{fields:n,errors:o,submit:!1}},computed:{SLOT:function(){return a},CLASS:function(){return d},UTILS:function(){return u},globalAv:function(){return this.activeValidation||!1},globalAvDelay:function(){return this.activeValidationDelay||0},allFieldsArray:function(){var e;return u.isArr(null===(e=this.schema)||void 0===e?void 0:e[c])?this.schema[c]:[]},allFieldsFlatArray:function(){var e=[];return this.allFieldsArray.forEach((function(n){u.isArr(n)?n.forEach((function(n){e.push(n)})):e.push(n)})),e},allFieldsFlatObj:function(){var e=this.allFieldsFlatArray.map((function(e){return[e.model,e]}));return Object.fromEntries(e)},debounceValidateField:function(){var e=this;return u.debounce((function(n){e.fieldValidation(n)}))}},watch:{disabled:{handler:function(e){e&&this.removeAllErrors()}},value:{handler:function(){var e,n=this;Object.keys((null===(e=this.value)||void 0===e?void 0:e[f])||{}).forEach((function(e){var o,t,r,i;n.fields[e]=null===(o=n.value)||void 0===o||null===(t=o[f])||void 0===t?void 0:t[e],n.errors[e]=null===(r=n.value)||void 0===r||null===(i=r[v])||void 0===i?void 0:i[e]}))},deep:!0},fields:{handler:function(){var e;this.$emit("input",(t(e={},f,this.fields),t(e,v,this.errors),e))},deep:!0,immediate:!0}},created:function(){var e=this;Object.keys(this.fields).forEach((function(o){var t=e.fieldConf(o);e.$watch("fields.".concat(o),(function(o,r){e.typeCoercion(t),o==r&&n(o)!==n(r)||e.validate(t,!0)}),{deep:!0})}))},methods:{resetForm:function(){this.submit=!1},schemaValid:function(){var e,n,o;return u.isArr(null===(e=this.schema)||void 0===e?void 0:e[c])&&(null===(n=this.schema)||void 0===n||null===(o=n[c])||void 0===o?void 0:o.length)},showRow:function(e){return u.isArr(e)?this.showCols(e):this.showCol(e)},showCols:function(e){var n=this;return e.length&&e.some((function(e){return n.showCol(e)}))},showCol:function(e){return this.componentName(e)&&!this.fieldHidden(e)},slotProps:function(e){return u.isArr(e)?e.map((function(e){return e.model})):[e.model]},componentProps:function(e){var n,o=this.componentName(e),r=this.componentData(o),l=null==r?void 0:r.errorProp;return i(i(i({},l?t({},l,this.errors[e.model]):{}),e.vBind),{},{type:(null==e||null===(n=e.vBind)||void 0===n?void 0:n.type)||b.text})},removeAllErrors:function(){var e=this;Object.keys(this.errors).forEach((function(n){e.errors[n]=""}))},setError:function(e,n){var o=this.errors[e];o===n||u.isObj([o,n])&&JSON.stringify(o)===JSON.stringify(n)||(this.errors[e]=n)},componentData:function(e){return this.components.find((function(n){return(null==n?void 0:n.name)===e}))},typeCoercion:function(e){var n;Number.isNaN(Number(this.fields[e.model]))&&(null==e||null===(n=e.vBind)||void 0===n?void 0:n.type)===b.number&&this.fields[e.model]&&(this.fields[e.model]=Number(this.fields[e.model]))},componentEvents:function(e){return u.isObj(null==e?void 0:e[p])?null==e?void 0:e[p]:{}},componentName:function(e){var n,o,t=(null==e||null===(n=e.vBind)||void 0===n?void 0:n.type)||b.text,r=this.components.find((function(e){return e.types.includes(t)})),i=(null==e||null===(o=e.vBind)||void 0===o?void 0:o.is)||(null==r?void 0:r.name);return i},fieldConf:function(e){return this.allFieldsFlatObj[e]},fieldDisabled:function(e){var n=!!(u.isObj(null==e?void 0:e.vBind)&&y.disabled in e.vBind)&&u.handleFuncOrBool(e.vBind[y.disabled]);return this.disabled||n},fieldRequired:function(e){var n=!!((null==e?void 0:e.vBind)&&y.required in e.vBind)&&u.handleFuncOrBool(e.vBind[y.required]);return n},fieldHidden:function(e){var n=!!(u.isObj(null==e?void 0:e.vBind)&&y.hidden in e.vBind)&&u.handleFuncOrBool(e.vBind[y.hidden]);return n},fieldValidation:function(e){var n=this.fieldRequired(e),o=null==e?void 0:e[_],t=(null==e?void 0:e[m])||this.globalAv,r=(this.submit||t)&&u.handleFunc(o)||"";return n?this.setError(e.model,r):this.submit||this.setError(e.model,r),this.logs&&console.log(e.model,{value:this.fields[e.model],valid:!r,required:n,error:r}),r},validate:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n||!o){var t={};Object.values(this.allFieldsFlatObj).forEach((function(n){var o=e.fieldValidation(n);t[n.model]=!o||!e.fieldRequired(n)}));var r=Object.keys(t).find((function(e){return!t[e]}));return{validationsStatus:t,submitFail:r}}var i=n[m]||this.globalAv,l=n[h]||this.globalAvDelay;i&&l?this.debounceValidateField(l)(n):this.fieldValidation(n)},handleSubmit:function(){var e,n=this;return(e=regeneratorRuntime.mark((function e(){var o,t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.submit=!0,o=n.validate(),t=o.validationsStatus,r=o.submitFail,n.logs&&console.log("form validations:",t),!r){e.next=8;break}return n.resetForm(),e.next=7,n.onSubmitFail();case 7:return e.abrupt("return");case 8:return e.next=10,n.onSubmit();case 10:n.resetForm();case 11:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var l=e.apply(n,t);function s(e){o(l,r,i,s,u,"next",e)}function u(e){o(l,r,i,s,u,"throw",e)}s(void 0)}))})()}}},void 0,!1,void 0,!1,void 0,void 0,void 0),S=function(e){S.installed||(S.installed=!0,e.component("FormGeneratorVue",w))},C={install:S},g=null;return"undefined"!=typeof window?g=window.Vue:"undefined"!=typeof global&&(g=global.Vue),g&&g.use(C),w.install=S,e.default=w,e}({});